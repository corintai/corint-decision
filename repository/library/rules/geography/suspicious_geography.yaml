version: "0.1"

# Reusable suspicious geography detection rule
rule:
  id: suspicious_geography_pattern
  name: Suspicious Geography Detection
  description: Detect suspicious geographic patterns like multiple IPs or cities

  when:
    any:
      # Multiple IPs in 24 hours
      - features.unique_ips_24h >= 5
      # Multiple cities in 30 days
      - features.unique_cities_30d >= 5
      # High IP risk score
      - features.ip_risk_score >= 0.7

  score: 60

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Risk Analysis Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: geography
    severity: medium
    tags: [account_takeover, vpn_abuse, proxy_fraud]
    description_detail: "Multiple IPs/cities or high-risk IP"
    detection: "unique_ips_24h >= 5 OR unique_cities_30d >= 5 OR ip_risk_score >= 0.7"
    features:
      - unique_ips_24h: "Distinct IPs in 24 hours"
      - unique_cities_30d: "Distinct cities in 30 days"
      - ip_risk_score: "Pre-computed IP risk score"
