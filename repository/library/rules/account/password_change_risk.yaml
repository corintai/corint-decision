version: "0.1"

# High-Risk Password Change Detection Rule
rule:
  id: password_change_risk
  name: High-Risk Password Change
  description: Detect high-risk password change behavior

  when:
    event.type: password_change
    conditions:
      # Any of these conditions indicate risk
      - any:
          - features.is_new_device == true
          - features.country_changed == true
          - features.failed_login_count_1h >= 3

  score: 70

  metadata:
    category: account
    severity: high
    tags: [password_change, account_takeover, credential_compromise]
    rule_version: "1.0.0"
    last_updated: "2025-12-14"
    description_detail: "Detects password changes from new devices, changed countries, or after failed login attempts"
    detection: "is_new_device OR country_changed OR failed_logins >= 3"
    features:
      - is_new_device: "Whether device is new/unknown for this user"
      - country_changed: "Whether user's country has changed"
      - failed_login_count_1h: "Failed login attempts in last 1 hour"
