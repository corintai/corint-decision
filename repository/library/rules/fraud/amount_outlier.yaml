version: "0.1"

# Reusable amount outlier detection rule
rule:
  id: amount_outlier_pattern
  name: Amount Outlier Detection
  description: Detect transaction amounts that are unusually high

  when:
    all:
      # Current amount significantly exceeds average
      - event.amount > features.avg_transaction_30d * 3
      # AND exceeds absolute threshold
      - event.amount > 2000
      # AND exceeds max in past 14 days
      - event.amount > features.max_transaction_14d

  score: 75

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: high
    tags: [account_takeover, stolen_cards, money_laundering]
    description_detail: "Transaction amount is unusually high compared to history"
    detection: "event.amount > avg_transaction_30d * 3 AND event.amount > 2000 AND event.amount > max_transaction_14d"
    features:
      - avg_transaction_30d: "Average transaction in 30 days"
      - max_transaction_14d: "Maximum transaction in 14 days"
      - event.amount: "Current transaction amount"
