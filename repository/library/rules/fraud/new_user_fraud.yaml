version: "0.1"

# Reusable new user fraud detection rule
rule:
  id: new_user_fraud_pattern
  name: New User Fraud Detection
  description: Detect new accounts with immediate high-risk behavior

  when:
    all:
      # Account created within past 7 days (with null-safe check)
      - any:
          - features.account_age_days < 7
          - features.account_age_days == null  # If unavailable, assume potential new user risk
      # AND (large amount OR unverified user OR unverified status unavailable)
      - any:
          - event.amount > 1000
          - features.user_is_verified == false
          - features.user_is_verified == null  # If verification status unavailable, treat as unverified

  score: 50

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"
