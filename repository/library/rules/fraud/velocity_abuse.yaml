version: "0.1"

# Reusable velocity abuse detection rule
rule:
  id: velocity_abuse_pattern
  name: Velocity Abuse Detection
  description: Detect abnormally high transaction frequency

  when:
    any:
      # Too many transactions in 24 hours
      - features.transaction_count_24h > 10
      # High transaction sum in 24 hours
      - features.transaction_sum_24h > 5000

  score: 70

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: high
    tags: [carding, automated_fraud, bot_attacks]
    description_detail: "Abnormally high transaction frequency or volume"
    detection: "transaction_count_24h > 10 OR transaction_sum_24h > 5000"
    features:
      - transaction_count_24h: "Transactions in 24h"
      - transaction_sum_24h: "Total transaction amount in 24h"
