version: "0.1"

# Reusable velocity abuse detection rule
rule:
  id: velocity_abuse_pattern
  name: Velocity Abuse Detection
  description: Detect abnormally high transaction frequency

  when:
    all:
      # Too many transactions in 24 hours OR velocity spike
      - transaction_count_24h > 20 || velocity_ratio > 5.0

  score: 70

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: high
    tags: [carding, automated_fraud, bot_attacks]
    description_detail: "Abnormally high transaction frequency"
    detection: "transaction_count_24h > 20 OR velocity_ratio > 5.0"
    features:
      - transaction_count_24h: "Transactions in 24h"
      - velocity_ratio: "Current vs 7-day average velocity"
