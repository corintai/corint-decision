version: "0.1"

# Unified account takeover detection rule
rule:
  id: account_takeover
  name: Account Takeover Detection
  description: Detect unauthorized account access through multiple risk signals

  when:
    all:
      - any:
          - features.is_new_device == true
          - features.failed_login_count_1h >= 3
          - features.country_changed == true

  score: 85

  metadata:
    # Required fields
    version: "2.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: high
    tags: [credential_stuffing, phishing, malware, brute_force, location_anomaly, account_takeover]
    description_detail: "Detects account takeover attempts via new device, failed logins, or geographic changes"
    detection: "is_new_device OR failed_login_count_1h >= 3 OR country_changed"
    features:
      - is_new_device: "Device never seen before for this account"
      - failed_login_count_1h: "Failed login attempts in last 1 hour"
      - country_changed: "Login from different country than usual"
