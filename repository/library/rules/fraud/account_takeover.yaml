version: "0.1"

# Reusable account takeover detection rule - New Device
rule:
  id: account_takeover_new_device
  name: Account Takeover - New Device
  description: Detect unauthorized access from new device

  when:
    conditions:
      - features.is_new_device == true

  score: 85

  metadata:
    category: fraud
    severity: high
    tags: [credential_stuffing, phishing, malware]
    rule_version: "1.0.0"
    last_updated: "2025-12-14"
    description_detail: "Unauthorized access from new device with suspicious activity"
    detection: "is_new_device OR failed_login_count_1h >= 3 OR country_changed"
    features:
      - is_new_device: "Device never seen before"
      - failed_login_count_1h: "Failed attempts in last hour"
      - country_changed: "Geographic location changed"
