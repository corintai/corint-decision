version: "0.1"

# Unified account takeover detection rule
rule:
  id: account_takeover_pattern
  name: Account Takeover Detection
  description: Detect unauthorized account access through multiple risk signals

  when:
    any:
      # Multiple failed login attempts
      - features.failed_login_count_1h >= 3
      # Multiple devices in short time
      - features.unique_devices_7d >= 5
      # High user risk score
      - features.user_risk_score >= 0.7

  score: 85

  metadata:
    # Required fields
    version: "2.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: high
    tags: [credential_stuffing, phishing, malware, brute_force, account_takeover]
    description_detail: "Detects account takeover attempts via failed logins, multiple devices, or high risk score"
    detection: "failed_login_count_1h >= 3 OR unique_devices_7d >= 5 OR user_risk_score >= 0.7"
    features:
      - failed_login_count_1h: "Failed login attempts in last 1 hour"
      - unique_devices_7d: "Number of distinct devices in last 7 days"
      - user_risk_score: "Pre-computed user risk score"
