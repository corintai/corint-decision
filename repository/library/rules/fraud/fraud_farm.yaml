version: "0.1"

# Reusable fraud farm detection rule
rule:
  id: fraud_farm_pattern
  name: Fraud Farm Detection
  description: Detect organized fraud farms with high IP/device association

  when:
    all:
      # Multiple devices from same IP (5h window)
      - features.devices_per_ip_5h > 10
      # And multiple users from same IP
      - features.users_per_ip_24h > 5

  score: 100

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: critical
    tags: [organized_fraud, bot_networks, credential_stuffing]
    description_detail: "Multiple devices/users from same IP"
    detection: "devices_per_ip_5h > 10 AND users_per_ip_24h > 5"
    features:
      - devices_per_ip_5h: "Devices from same IP (5h window)"
      - users_per_ip_24h: "Users from same IP (24h window)"
