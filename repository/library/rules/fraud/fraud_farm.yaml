version: "0.1"

# Reusable fraud farm detection rule
rule:
  id: fraud_farm_pattern
  name: Fraud Farm Detection
  description: Detect organized fraud farms with high IP/device association

  when:
    all:
      # Multiple devices from same IP (5h window)
      - ip_device_count > 10
      # And multiple users from same IP
      - ip_user_count > 5

  score: 100

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Fraud Prevention Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: fraud
    severity: critical
    tags: [organized_fraud, bot_networks, credential_stuffing]
    description_detail: "Multiple devices/users from same IP"
    detection: "ip_device_count > 10 AND ip_user_count > 5"
    features:
      - ip_device_count: "Devices from same IP (5h window)"
      - ip_user_count: "Users from same IP (5h window)"
