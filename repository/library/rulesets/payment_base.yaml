version: "0.1"

# Base payment risk ruleset
# This is the parent ruleset that defines common payment rules

import:
  rules:
    - library/rules/geography/suspicious_ip.yaml
    - library/rules/payment/card_testing.yaml
    - library/rules/payment/velocity_check.yaml
    - library/rules/payment/new_account_risk.yaml
    - library/rules/payment/suspicious_email.yaml

---

ruleset:
  id: payment_base
  name: Base Payment Risk Ruleset
  description: Common payment risk rules shared across all payment types

  rules:
    - suspicious_ip
    - card_testing
    - velocity_check
    - new_account_risk
    - suspicious_email

  # Base decision logic (can be overridden by child rulesets)
  conclusion:
    # Critical patterns
    - when: triggered_rules contains "card_testing"
      signal: decline
      reason: "Card testing detected"

    # Default action
    - default: true
      signal: approve
      reason: "No risk detected"

  metadata:
    # Required fields
    version: "1.0.0"
    author: "Risk Engineering Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    category: "payment"
