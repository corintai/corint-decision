version: "0.1"

# High-value payment ruleset (extends payment_base)
# Stricter thresholds for large transactions

imports:
  rulesets:
    - library/rulesets/payment_base.yaml
  rules:
    - library/rules/fraud/amount_outlier.yaml  # Add extra rule on top of base

---

ruleset:
  id: payment_high_value_v2
  name: High-Value Payment Risk Ruleset (with Inheritance)
  extends: payment_base  # Inherit from payment_base
  description: Stricter thresholds for high-value transactions (> $1000)

  # Add additional rules beyond what payment_base provides
  rules:
    - amount_outlier  # This gets merged with inherited rules

  # Override decision logic with stricter thresholds
  conclusion:
    # Critical patterns (stricter than standard)
    - when: |
        triggered_rules contains "card_testing" ||
        triggered_rules contains "new_account_risk" ||
        triggered_rules contains "amount_outlier"
      signal: decline
      reason: "Critical fraud pattern detected for high-value transaction"

    # High score threshold (stricter than standard: 60 vs 100)
    - when: total_score >= 60
      signal: decline
      reason: "Risk score too high for large transaction"

    # Multiple risk indicators (stricter)
    - when: triggered_count >= 2
      signal: review
      reason: "Multiple risk indicators detected"

    # Single risk indicator requires challenge
    - when: triggered_count >= 1
      signal: hold
      reason: "Require 3DS authentication for high-value transaction"

    # Clean high-value transaction
    - default: true
      signal: approve
      reason: "Clean high-value transaction"

  metadata:
    # Required fields
    version: "2.0.0"
    author: "Risk Engineering Team"
    updated: "2025-12-20 10:00:00"

    # Custom fields
    parent: "payment_base"
    transaction_limit: 10000
    strictness: "high"
